=== Docker build Dockerfile.bridge-local-git
[2019-01-17 20:05.10] Starting...
Cloning into '/tmp/with_clone196bf86a'...
done.
HEAD is now at 5ca8acc include synopsis and description in opam 2 metadata
[2019-01-17 20:05.10] Rewrite Dockerfile's first line to:
FROM sha256:c50f50cdd9f6682e1cee1ee8df737fa2843f0a22b6f4afff01c1a1b8b72f25c4
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 5.677 MB
Step 1/10 : FROM sha256:c50f50cdd9f6682e1cee1ee8df737fa2843f0a22b6f4afff01c1a1b8b72f25c4
 ---> c50f50cdd9f6
Step 2/10 : COPY . /home/opam/src/datakit
 ---> 8a2c370fcf12
Removing intermediate container 03f10009fe20
Step 3/10 : RUN sudo chown opam.nogroup -R /home/opam/src/datakit
 ---> Running in a7bd23110697
 ---> 30bf61b8f408
Removing intermediate container a7bd23110697
Step 4/10 : RUN opam update --dev && opam upgrade
 ---> Running in 1540e887f501

<><> Synchronising development packages <><><><><><><><><><><><><><><><><><><><>
[datakit.0.12.0] synchronised from file:///home/opam/src/datakit
[datakit-bridge-github.0.12.0] synchronised from file:///home/opam/src/datakit
[datakit-bridge-local-git.0.12.0] synchronised from file:///home/opam/src/datakit
[datakit-ci.0.12.1] synchronised from file:///home/opam/src/datakit
[datakit-client.0.12.0] synchronised from file:///home/opam/src/datakit
[datakit-client-9p.0.12.0] synchronised from file:///home/opam/src/datakit
[datakit-client-git.0.12.0] synchronised from file:///home/opam/src/datakit
[datakit-github.0.12.0] synchronised from file:///home/opam/src/datakit
[datakit-server.0.12.0] synchronised from file:///home/opam/src/datakit
[datakit-server-9p.0.12.0] synchronised from file:///home/opam/src/datakit
Now run 'opam upgrade' to apply any package updates.
The following actions will be performed:
  - recompile datakit-client     0.12.0* [upstream changes]
  - recompile datakit-client-git 0.12.0* [upstream changes]
  - recompile datakit-client-9p  0.12.0* [upstream changes]
===== 3 to recompile =====

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> removed   datakit-client-9p.0.12.0
-> removed   datakit-client-git.0.12.0
-> removed   datakit-client.0.12.0
-> installed datakit-client.0.12.0
-> installed datakit-client-9p.0.12.0
-> installed datakit-client-git.0.12.0
Done.
# Run eval $(opam env) to update the current shell environment
 ---> 27a63ac8036b
Removing intermediate container 1540e887f501
Step 5/10 : RUN opam install datakit-bridge-local-git -tyv
 ---> Running in fb48b91a0201

<><> Synchronising pinned packages ><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/1: [datakit-bridge-local-git.0.12.0: rsync]
[datakit-bridge-local-git.0.12.0] synchronised from file:///home/opam/src/datakit

The following actions will be performed:
  - install crunch                   2.1.0   [required by irmin-http]
  - install datakit-github           0.12.0* [required by datakit-bridge-local-git]
  - install irmin-fs                 1.3.0   [required by irmin-unix]
  - install dispatch                 0.4.0   [required by webmachine]
  - install calendar                 2.04    [required by webmachine]
  - install webmachine               0.5.0   [required by irmin-http]
  - install irmin-http               1.3.3   [required by irmin-unix]
  - install irmin-unix               1.3.3   [required by datakit-bridge-local-git]
  - install datakit-bridge-local-git 0.12.0*
===== 9 to install =====

<><> Gathering sources ><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/9: [calendar.2.04: http]
Processing  2/9: [calendar.2.04: http] [crunch.2.1.0: http]
Processing  3/9: [calendar.2.04: http] [crunch.2.1.0: http]
Processing  4/9: [calendar.2.04: http] [crunch.2.1.0: http]
Processing  5/9: [calendar.2.04: http] [crunch.2.1.0: http] [dispatch.0.4.0: http]
[calendar.2.04] downloaded from https://forge-static.ocamlcore.org/frs/download.php/1481/calendar-2.04.tar.gz
Processing  5/9: [crunch.2.1.0: http] [dispatch.0.4.0: http]
[irmin-fs.1.3.0] found in cache
Processing  6/9: [crunch.2.1.0: http] [dispatch.0.4.0: http]
Processing  7/9: [crunch.2.1.0: http] [dispatch.0.4.0: http] [irmin-http.1.3.3: http]
[dispatch.0.4.0] downloaded from https://github.com/inhabitedtype/ocaml-dispatch/archive/0.4.0.tar.gz
Processing  7/9: [crunch.2.1.0: http] [irmin-http.1.3.3: http]
Processing  8/9: [crunch.2.1.0: http] [irmin-http.1.3.3: http] [irmin-unix.1.3.3: http]
[crunch.2.1.0] downloaded from https://github.com/mirage/ocaml-crunch/releases/download/v2.1.0/crunch-2.1.0.tbz
Processing  8/9: [irmin-http.1.3.3: http] [irmin-unix.1.3.3: http]
Processing  9/9: [irmin-http.1.3.3: http] [irmin-unix.1.3.3: http] [webmachine.0.5.0: http]
[irmin-http.1.3.3] downloaded from https://github.com/mirage/irmin/releases/download/1.3.3/irmin-1.3.3.tbz
Processing  9/9: [irmin-unix.1.3.3: http] [webmachine.0.5.0: http]
[webmachine.0.5.0] downloaded from https://github.com/inhabitedtype/ocaml-webmachine/archive/0.5.0.tar.gz
Processing  9/9: [irmin-unix.1.3.3: http]
[irmin-unix.1.3.3] downloaded from https://github.com/mirage/irmin/releases/download/1.3.3/irmin-1.3.3.tbz
Processing  9/9:

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/18: [calendar: ./configure]
Processing  2/18: [calendar: ./configure] [crunch: jbuilder build]
Processing  3/18: [calendar: ./configure] [crunch: jbuilder build] [datakit-github: dune build]
Processing  4/18: [calendar: ./configure] [crunch: jbuilder build] [datakit-github: dune build] [dispatch: jbuilder build]
Processing  5/18: [calendar: ./configure] [crunch: jbuilder build] [datakit-github: dune build] [dispatch: jbuilder build] [irmin-fs: jbuilder build]
+ /home/opam/.opam/4.07/.opam-switch/build/calendar.2.04/./configure  (CWD=/home/opam/.opam/4.07/.opam-switch/build/calendar.2.04)
- checking for ocamlc... ocamlc
- ocaml version is 4.07.1: Good!
- ocaml library path is /home/opam/.opam/4.07/lib/ocaml
- checking for ocamlopt... ocamlopt
- checking ocamlopt version... ok
- checking for ocamlc.opt... ocamlc.opt
- checking ocamlc.opt version... ok
- checking for ocamlopt.opt... ocamlopt.opt
- checking ocamlc.opt version... ok
- checking for ocamldep... ocamldep
- checking for ocamlfind... ocamlfind
- checking for ocamldoc... ocamldoc
- checking for ocamlweb... ocamlweb
- checking for ocamlwc... ocamlwc
- checking for ocamldot... ocamldot
- checking platform... linux
- checking extension for object files... .o
- checking extension for library files... .a
- checking for /home/opam/.opam/4.07/lib/ocaml/dynlink.cmxa... yes
- native dynlink works fine. Great.
- configure: creating ./config.status
- config.status: creating Makefile
- checking for ocamlc... ocamlc
- ocaml version is 4.07.1: Good!
- ocaml library path is /home/opam/.opam/4.07/lib/ocaml
- checking for ocamlopt... ocamlopt
- checking ocamlopt version... ok
- checking for ocamlc.opt... ocamlc.opt
- checking ocamlc.opt version... ok
- checking for ocamlopt.opt... ocamlopt.opt
- checking ocamlc.opt version... ok
- checking for ocamldep... ocamldep
- checking for ocamlfind... ocamlfind
- checking for ocamldoc... ocamldoc
- checking for ocamlweb... ocamlweb
- checking for ocamlwc... ocamlwc
- checking for ocamldot... ocamldot
- checking platform... linux
- checking extension for object files... .o
- checking extension for library files... .a
- checking for /home/opam/.opam/4.07/lib/ocaml/dynlink.cmxa... yes
- native dynlink works fine. Great.
- configure: creating ./config.status
- config.status: creating Makefile
Processing  5/18: [calendar: make] [crunch: jbuilder build] [datakit-github: dune build] [dispatch: jbuilder build] [irmin-fs: jbuilder build]
+ /home/opam/.opam/4.07/bin/jbuilder "build" "-p" "dispatch" "-j" "127" (CWD=/home/opam/.opam/4.07/.opam-switch/build/dispatch.0.4.0)
-> compiled  dispatch.0.4.0
Processing  5/18: [calendar: make] [crunch: jbuilder build] [datakit-github: dune build] [irmin-fs: jbuilder build]
-> installed dispatch.0.4.0
Processing  6/18: [calendar: make] [crunch: jbuilder build] [datakit-github: dune build] [irmin-fs: jbuilder build]
+ /home/opam/.opam/4.07/bin/jbuilder "build" "-p" "crunch" "-j" "127" (CWD=/home/opam/.opam/4.07/.opam-switch/build/crunch.2.1.0)
-> compiled  crunch.2.1.0
Processing  6/18: [calendar: make] [datakit-github: dune build] [irmin-fs: jbuilder build]
-> installed crunch.2.1.0
Processing  7/18: [calendar: make] [datakit-github: dune build] [irmin-fs: jbuilder build]
+ /home/opam/.opam/4.07/bin/dune "build" "-p" "datakit-github" "-j" "127" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit-github.0.12.0)
-> compiled  datakit-github.0.12.0
Processing  7/18: [calendar: make] [irmin-fs: jbuilder build]
-> installed datakit-github.0.12.0
Processing  8/18: [calendar: make] [irmin-fs: jbuilder build]
+ /home/opam/.opam/4.07/bin/jbuilder "build" "-p" "irmin-fs" "-j" "127" (CWD=/home/opam/.opam/4.07/.opam-switch/build/irmin-fs.1.3.0)
-> compiled  irmin-fs.1.3.0
Processing  8/18: [calendar: make]
-> installed irmin-fs.1.3.0
Processing  9/18: [calendar: make]
+ /usr/bin/make  (CWD=/home/opam/.opam/4.07/.opam-switch/build/calendar.2.04)
- echo "let version = \"2.04\"" > src/version.ml
- echo "let date = \"`date`\"" >> src/version.ml
- rm -f .depend
- ocamldep -I src -I tests src/*.ml src/*.mli tests/*.ml tests/*.mli \
-   > .depend
- ocamlc.opt -I src -I target -I tests -c src/period.mli
- ocamlc.opt -I src -I target -I tests -c src/date_sig.mli
- ocamlc.opt -I src -I target -I tests -c src/time_Zone.mli
- ocamlc.opt -I src -I target -I tests -c src/time_sig.mli
- ocamlc.opt -I src -I target -I tests -c src/calendar_sig.mli
- ocamlc.opt -I src -I target -I tests -c src/utils.mli
- ocamlc.opt -I src -I target -I tests -c src/utils.ml
- ocamlc.opt -I src -I target -I tests -c src/time_Zone.ml
- ocamlc.opt -I src -I target -I tests -c src/time.mli
- ocamlc.opt -I src -I target -I tests -c src/time.ml
- ocamlc.opt -I src -I target -I tests -c src/ftime.mli
- ocamlc.opt -I src -I target -I tests -c src/ftime.ml
- ocamlc.opt -I src -I target -I tests -c src/date.mli
- ocamlc.opt -I src -I target -I tests -c src/date.ml
- ocamlc.opt -I src -I target -I tests -c src/calendar_builder.mli
- ocamlc.opt -I src -I target -I tests -c src/calendar_builder.ml
- ocamlc.opt -I src -I target -I tests -c src/calendar.mli
- ocamlc.opt -I src -I target -I tests -c src/calendar.ml
- ocamlc.opt -I src -I target -I tests -c src/fcalendar.mli
- ocamlc.opt -I src -I target -I tests -c src/fcalendar.ml
- ocamlc.opt -I src -I target -I tests -c src/printer.mli
- ocamlc.opt -I src -I target -I tests -c src/printer.ml
- File "src/printer.ml", line 184, characters 16-32:
- Warning 3: deprecated: Stdlib.String.uppercase
- Use String.uppercase_ascii instead.
- File "src/printer.ml", line 239, characters 33-49:
- Warning 3: deprecated: Stdlib.String.lowercase
- Use String.lowercase_ascii instead.
- ocamlc.opt -I src -I target -I tests -c src/version.mli
- ocamlc.opt -I src -I target -I tests -c src/version.ml
- mkdir -p target
- ocamlfind ocamlc -I src -I target -I tests -pack -o target/calendarLib.cmo \
- 	src/period.cmi src/date_sig.cmi src/time_sig.cmi src/calendar_sig.cmi src/utils.cmo src/time_Zone.cmo src/time.cmo src/ftime.cmo src/date.cmo src/calendar_builder.cmo src/calendar.cmo src/fcalendar.cmo src/printer.cmo src/version.cmo
- ocamlfind ocamlc -I src -I target -I tests -a -o target/calendarLib.cma target/calendarLib.cmo
- ocamlopt.opt -I src -I target -I tests -noassert -for-pack CalendarLib -c src/utils.ml
- ocamlopt.opt -I src -I target -I tests -noassert -for-pack CalendarLib -c src/time_Zone.ml
- ocamlopt.opt -I src -I target -I tests -noassert -for-pack CalendarLib -c src/time.ml
- ocamlopt.opt -I src -I target -I tests -noassert -for-pack CalendarLib -c src/ftime.ml
- ocamlopt.opt -I src -I target -I tests -noassert -for-pack CalendarLib -c src/date.ml
- ocamlopt.opt -I src -I target -I tests -noassert -for-pack CalendarLib -c src/calendar_builder.ml
- ocamlopt.opt -I src -I target -I tests -noassert -for-pack CalendarLib -c src/calendar.ml
- ocamlopt.opt -I src -I target -I tests -noassert -for-pack CalendarLib -c src/fcalendar.ml
- ocamlopt.opt -I src -I target -I tests -noassert -for-pack CalendarLib -c src/printer.ml
- File "src/printer.ml", line 184, characters 16-32:
- Warning 3: deprecated: Stdlib.String.uppercase
- Use String.uppercase_ascii instead.
- File "src/printer.ml", line 239, characters 33-49:
- Warning 3: deprecated: Stdlib.String.lowercase
- Use String.lowercase_ascii instead.
- ocamlopt.opt -I src -I target -I tests -noassert -for-pack CalendarLib -c src/version.ml
- mkdir -p target
- ocamlfind ocamlopt -I src -I target -I tests -noassert -pack -o target/calendarLib.cmx \
- 	src/period.cmi src/date_sig.cmi src/time_sig.cmi src/calendar_sig.cmi src/utils.cmx src/time_Zone.cmx src/time.cmx src/ftime.cmx src/date.cmx src/calendar_builder.cmx src/calendar.cmx src/fcalendar.cmx src/printer.cmx src/version.cmx
- ocamlfind ocamlopt -I src -I target -I tests -noassert -a -o target/calendarLib.cmxa target/calendarLib.cmx
- ocamlfind ocamlopt -I target -shared -linkall -o target/calendarLib.cmxs target/calendarLib.cmxa
- echo "name = \"calendar\"" > META
- echo "description = \"calendar library\"" >> META
- echo "version = \"2.04\"" >> META
- echo "archive(byte) = \"calendarLib.cma\"" >> META
- echo "archive(native) = \"calendarLib.cmxa\"" >> META
- echo "requires = \"unix str\"" >> META
-> compiled  calendar.2.04
Processing 10/18: [calendar: make install]
+ /usr/bin/make "install" (CWD=/home/opam/.opam/4.07/.opam-switch/build/calendar.2.04)
- Installed /home/opam/.opam/4.07/lib/calendar/calendarLib.a
- Installed /home/opam/.opam/4.07/lib/calendar/calendarLib.o
- Installed /home/opam/.opam/4.07/lib/calendar/version.mli
- Installed /home/opam/.opam/4.07/lib/calendar/printer.mli
- Installed /home/opam/.opam/4.07/lib/calendar/fcalendar.mli
- Installed /home/opam/.opam/4.07/lib/calendar/calendar.mli
- Installed /home/opam/.opam/4.07/lib/calendar/calendar_builder.mli
- Installed /home/opam/.opam/4.07/lib/calendar/calendar_sig.mli
- Installed /home/opam/.opam/4.07/lib/calendar/date.mli
- Installed /home/opam/.opam/4.07/lib/calendar/date_sig.mli
- Installed /home/opam/.opam/4.07/lib/calendar/ftime.mli
- Installed /home/opam/.opam/4.07/lib/calendar/time.mli
- Installed /home/opam/.opam/4.07/lib/calendar/time_sig.mli
- Installed /home/opam/.opam/4.07/lib/calendar/period.mli
- Installed /home/opam/.opam/4.07/lib/calendar/time_Zone.mli
- Installed /home/opam/.opam/4.07/lib/calendar/utils.mli
- Installed /home/opam/.opam/4.07/lib/calendar/calendarLib.cmxs
- Installed /home/opam/.opam/4.07/lib/calendar/calendarLib.cmxa
- Installed /home/opam/.opam/4.07/lib/calendar/calendarLib.cmx
- Installed /home/opam/.opam/4.07/lib/calendar/calendarLib.cmo
- Installed /home/opam/.opam/4.07/lib/calendar/calendarLib.cmi
- Installed /home/opam/.opam/4.07/lib/calendar/calendarLib.cma
- Installed /home/opam/.opam/4.07/lib/calendar/META
-> installed calendar.2.04
Processing 11/18: [webmachine: jbuilder build]
+ /home/opam/.opam/4.07/bin/jbuilder "build" "-p" "webmachine" "-j" "127" (CWD=/home/opam/.opam/4.07/.opam-switch/build/webmachine.0.5.0)
-       ocamlc lib/.webmachine.objs/wm_util.{cmi,cmo,cmt}
- File "lib/wm_util.ml", line 95, characters 12-18:
- Warning 3: deprecated: module Re_str
- Use Re.Str
-     ocamlopt lib/.webmachine.objs/wm_util.{cmx,o}
- File "lib/wm_util.ml", line 95, characters 12-18:
- Warning 3: deprecated: module Re_str
- Use Re.Str
-> compiled  webmachine.0.5.0
-> installed webmachine.0.5.0
Processing 13/18: [irmin-http: jbuilder build]
+ /home/opam/.opam/4.07/bin/jbuilder "build" "-p" "irmin-http" "-j" "127" (CWD=/home/opam/.opam/4.07/.opam-switch/build/irmin-http.1.3.3)
-> compiled  irmin-http.1.3.3
-> installed irmin-http.1.3.3
Processing 15/18: [irmin-unix: jbuilder build]
+ /home/opam/.opam/4.07/bin/jbuilder "build" "-p" "irmin-unix" "-j" "127" (CWD=/home/opam/.opam/4.07/.opam-switch/build/irmin-unix.1.3.3)
-> compiled  irmin-unix.1.3.3
-> installed irmin-unix.1.3.3
Processing 17/18: [datakit-bridge-local-git: dune build]
+ /home/opam/.opam/4.07/bin/dune "build" "-p" "datakit-bridge-local-git" "-j" "127" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit-bridge-local-git.0.12.0)
-> compiled  datakit-bridge-local-git.0.12.0
-> installed datakit-bridge-local-git.0.12.0
Done.
# Run eval $(opam env) to update the current shell environment
 ---> 8472346e3ada
Removing intermediate container fb48b91a0201
Step 6/10 : RUN sudo cp $(opam config exec -- which datakit-bridge-local-git) /usr/bin/
 ---> Running in 25387ea6c81f
 ---> 411f3a9a2284
Removing intermediate container 25387ea6c81f
Step 7/10 : FROM alpine:3.8
 ---> 3f53bb00af94
Step 8/10 : RUN apk add --no-cache libev gmp tzdata ca-certificates
 ---> Running in f6de9f1cce82
fetch http://dl-cdn.alpinelinux.org/alpine/v3.8/main/x86_64/APKINDEX.tar.gz
fetch http://dl-cdn.alpinelinux.org/alpine/v3.8/community/x86_64/APKINDEX.tar.gz
(1/4) Installing ca-certificates (20171114-r3)
(2/4) Installing gmp (6.1.2-r1)
(3/4) Installing libev (4.24-r0)
(4/4) Installing tzdata (2018f-r0)
Executing busybox-1.28.4-r2.trigger
Executing ca-certificates-20171114-r3.trigger
OK: 9 MiB in 17 packages
 ---> 07189332bdef
Removing intermediate container f6de9f1cce82
Step 9/10 : ENTRYPOINT /usr/bin/datakit-bridge-local-git
 ---> Running in 83421b4498e9
 ---> 00fc74a29588
Removing intermediate container 83421b4498e9
Step 10/10 : COPY --from=0 /usr/bin/datakit-bridge-local-git /usr/bin/datakit-bridge-local-git
 ---> c7c22069a295
Removing intermediate container 208e80f9e365
Successfully built c7c22069a295
[2019-01-17 20:05.45] Success
