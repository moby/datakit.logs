=== Docker build Dockerfile.ci
[2017-02-07 11:54.01] Starting...
Cloning into '/tmp/with_clone281c1ab8'...
done.
HEAD is now at 20de9f3 Merge pull request #473 from talex5/split-prometheus
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 6.128 MBSending build context to Docker daemon 6.442 MB
Step 1/19 : FROM ocaml/opam:alpine-3.5_ocaml-4.04.0
alpine-3.5_ocaml-4.04.0: Pulling from ocaml/opam
Digest: sha256:29fbcdf704ed24b28d873c491db2d78e1e0eda8e8c81bf1c8bb5a95ddc17a5b6
Status: Image is up to date for ocaml/opam:alpine-3.5_ocaml-4.04.0
 ---> 6d8185a9354a
Step 2/19 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> 50f634ac6b91
Step 3/19 : RUN sudo apk add tzdata
 ---> Using cache
 ---> e3e04df67808
Step 4/19 : RUN opam depext -i opam-devel && sudo cp $(opam config var "opam-devel:lib")/opam /usr/bin/opam
 ---> Using cache
 ---> de857195ce8b
Step 5/19 : RUN rm -rf ~/.opam
 ---> Using cache
 ---> b33da6cc9763
Step 6/19 : RUN opam init -y
 ---> Using cache
 ---> e32acb65a7f8
Step 7/19 : RUN opam install ocaml -y
 ---> Using cache
 ---> d51c1d1a3c55
Step 8/19 : RUN opam install depext -y
 ---> Using cache
 ---> 3b4467ae7a7b
Step 9/19 : RUN opam pin add -yn datakit-client https://github.com/docker/datakit.git &&     opam pin add -yn github --dev &&     opam pin add -yn datakit-github https://github.com/talex5/datakit.git#split-prometheus &&     opam pin add -yn datakit-server https://github.com/talex5/datakit.git#split-prometheus &&     opam pin add -yn datakit https://github.com/talex5/datakit.git#split-prometheus
 ---> Using cache
 ---> 030044d6e911
Step 10/19 : ADD datakit-ci.opam /tmp/deps/opam
 ---> Using cache
 ---> 6568447ddb36
Step 11/19 : RUN opam pin add -y tmp /tmp/deps/opam -n
 ---> Using cache
 ---> a5cb10e7b2dd
Step 12/19 : RUN opam depext tmp -y
 ---> Using cache
 ---> df1dbc079cf5
Step 13/19 : RUN opam install --deps-only tmp -y
 ---> Using cache
 ---> f726dee7505c
Step 14/19 : ADD . /home/opam/datakit
 ---> e5b42af1ba47
Removing intermediate container 56c3024967e9
Step 15/19 : RUN sudo chown opam /home/opam/datakit
 ---> Running in 2d781af89cdb
 ---> 766c7701454d
Removing intermediate container 2d781af89cdb
Step 16/19 : RUN opam pin add -k git datakit-client /home/opam/datakit -y
 ---> Running in 3f2a3156ea4e
[91m[NOTE] Package datakit-client is currently pinned to git+https://github.com/docker/datakit.git (version 0.8.0).
[0mProceed and change pinning target ? [Y/n] y
[datakit-client: git]
[datakit-client: git]
[datakit-client] git+file:///home/opam/datakit changed
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/packages.dev/datakit-client/datakit-client.opam from 1.2 to 2.0~alpha3
[0mdatakit-client is now pinned to git+file:///home/opam/datakit (version 0.8.0)
[91m[NOTE] Pinning in mixed mode: OPAM will use tracked files in the current working tree from /home/opam/datakit. If this is not what you want, pin to a given branch (e.g. git+file:///home/opam/datakit#HEAD)
[0m
The following actions will be performed:
  - recompile datakit-client 0.8.0*
  - recompile datakit-github 0.8.1*                             [uses datakit-client]
===== 2 to recompile =====

=-=- Gathering sources =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Processing  1/2: [datakit-client: git]
Processing  2/2: [datakit-client: git] [datakit-github: git]
[datakit-client] git+file:///home/opam/datakit changed
Processing  2/2: [datakit-github: git]
[datakit-github] git+https://github.com/talex5/datakit.git#split-prometheus changed

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Processing  1/6: [datakit-client: ocaml build]
-> removed   datakit-github.0.8.1
-> removed   datakit-client.0.8.0
-> installed datakit-client.0.8.0
Processing  5/6: [datakit-github: ocaml build]
-> installed datakit-github.0.8.1
Done.
# Run eval `opam config env` to update the current shell environment
 ---> 452779ae53d4
Removing intermediate container 3f2a3156ea4e
Step 17/19 : RUN opam pin add -k git datakit-ci /home/opam/datakit -y
 ---> Running in 33184f0ea991
Package datakit-ci does not exist, create as a NEW package ? [Y/n] y
[datakit-ci: git]
[datakit-ci: git]
[datakit-ci] git+file:///home/opam/datakit changed
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/packages.dev/datakit-ci/datakit-ci.opam from 1.2 to 2.0~alpha3
[0mdatakit-ci is now pinned to git+file:///home/opam/datakit (version ~dev)

[91m[NOTE] Pinning in mixed mode: OPAM will use tracked files in the current working tree from /home/opam/datakit. If this is not what you want, pin to a given branch (e.g. git+file:///home/opam/datakit#HEAD)
[0mThe following actions will be performed:
  - install datakit-ci ~dev*

=-=- Gathering sources =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Processing  1/1: [datakit-ci: git]
[datakit-ci] git+file:///home/opam/datakit changed

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Processing  1/2: [datakit-ci: ocaml build]
-> installed datakit-ci.~dev
Done.
# Run eval `opam config env` to update the current shell environment
 ---> dcc5a493f585
Removing intermediate container 33184f0ea991
Step 18/19 : RUN opam pin add -k git datakit-github /home/opam/datakit -yn
 ---> Running in d4696222fcde
Proceed and change pinning target ? [Y/n] y
[91m[NOTE] Package datakit-github is currently pinned to git+https://github.com/talex5/datakit.git#split-prometheus (version 0.8.1).
[0m[datakit-github: git]
[datakit-github: git]
[datakit-github] git+file:///home/opam/datakit changed
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/packages.dev/datakit-github/datakit-github.opam from 1.2 to 2.0~alpha3
[0mdatakit-github is now pinned to git+file:///home/opam/datakit (version 0.8.1)
[91m[NOTE] Pinning in mixed mode: OPAM will use tracked files in the current working tree from /home/opam/datakit. If this is not what you want, pin to a given branch (e.g. git+file:///home/opam/datakit#HEAD)
[0m ---> 869607e5bbed
Removing intermediate container d4696222fcde
Step 19/19 : VOLUME /secrets
 ---> Running in 7bf464675d0f
 ---> 28f06cbd26fc
Removing intermediate container 7bf464675d0f
Successfully built 28f06cbd26fc
[2017-02-07 11:54.57] Success
